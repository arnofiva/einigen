import{e as t,y as i,H as w,d as y,T as Z,a as d,X as n,bF as j,Z as A,M as K,au as H,bu as Q,bS as T,S as q,G as $,R as E,E as W,bg as Y,bT as C,bE as ee,bx as M,bU as te,a6 as ie,P as se,bD as re}from"./index.da161cf1.js";import{v as D,p as g,j as oe,l as ne,A as L,w as k}from"./UniqueValueRenderer.0143139a.js";import{DictionaryLoader as z}from"./DictionaryLoader.90c8c47c.js";import{c as le,i as ae,a as ue}from"./heatmapUtils.32e9a30b.js";var I;let v=I=class extends w{constructor(e){super(e),this.color=null,this.ratio=null}clone(){return new I({color:this.color,ratio:this.ratio})}};t([i({type:y,json:{type:[Z],default:null,write:!0}})],v.prototype,"color",void 0),t([i({type:Number,json:{write:!0}})],v.prototype,"ratio",void 0),v=I=t([d("esri.renderers.support.HeatmapColorStop")],v);const f=v;var V;let p=V=class extends D(g){constructor(e){super(e),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}get _loader(){return new z(this.url,this.config,this.fieldMap)}writeData(e,s){e&&(s.scalingExpressionInfo={expression:e,returnType:"number"})}writeVisualVariables(e,s,r,u){u?.origin||super.writeVisualVariables(e,s,r,u)}clone(){return new V({config:n(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:n(this.fieldMap),url:n(this.url),visualVariables:n(this.visualVariables)})}async getSymbolAsync(e,s){return this._loader.getSymbolAsync(e,s)}async collectRequiredFields(e,s){await this.collectVVRequiredFields(e,s),this.scaleExpression&&await j(e,s,this.scaleExpression);for(const r in this.fieldMap){const u=this.fieldMap[r];s.has(u)&&e.add(u)}}get arcadeRequired(){return!0}getSymbol(){return null}getSymbols(){return[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((e,s)=>e+s.getAttributeHash(),"")}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}getSymbolFields(){return this._loader.getSymbolFields()}};t([i({type:z})],p.prototype,"_loader",null),t([i({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],p.prototype,"config",void 0),t([i({type:Object,json:{write:!0}})],p.prototype,"fieldMap",void 0),t([i({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],p.prototype,"scaleExpression",void 0),t([A("scaleExpression")],p.prototype,"writeData",null),t([i({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(e){return{enabled:!!e&&!!this.scaleExpression}}}}})],p.prototype,"scaleExpressionTitle",void 0),t([i({type:String,json:{write:!0}})],p.prototype,"url",void 0),t([A("visualVariables")],p.prototype,"writeVisualVariables",null),p=V=t([d("esri.renderers.DictionaryRenderer")],p);const pe=p;var P;let h=P=class extends w{constructor(e){super(e),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(e){return e==null?e:typeof e=="function"?(H.getLogger(this).error(".field: field must be a string value"),null):Q(e)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){return new P({color:this.color&&this.color.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};t([i({type:y,json:{type:[Number],write:!0}})],h.prototype,"color",void 0),t([i({type:String,json:{write:!0}})],h.prototype,"field",void 0),t([K("field")],h.prototype,"castField",null),t([i({type:String,json:{write:!0}})],h.prototype,"label",void 0),t([i({type:String,json:{write:!0}})],h.prototype,"valueExpression",void 0),t([i({type:String,json:{write:!0}})],h.prototype,"valueExpressionTitle",void 0),h=P=t([d("esri.renderers.support.AttributeColorInfo")],h);const B=h;var R;let x=R=class extends w{constructor(){super(...arguments),this.unit=null}clone(){return new R({unit:this.unit})}};t([i({type:String,json:{write:!0}})],x.prototype,"unit",void 0),x=R=t([d("esri.renderers.support.DotDensityLegendOptions")],x);const ye=x;var O;let l=O=class extends D(g){constructor(e){super(e),this.attributes=null,this.backgroundColor=new y([0,0,0,0]),this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new T,this.dotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}calculateDotValue(e){if(this.referenceScale==null)return this.dotValue;const s=e/this.referenceScale*this.dotValue;return s<1?1:s}getSymbol(){return new q({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}getAttributeHash(){return this.attributes?.reduce((e,s)=>e+s.getAttributeHash(),"")??""}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new O({attributes:n(this.attributes),backgroundColor:n(this.backgroundColor),dotBlendingEnabled:n(this.dotBlendingEnabled),dotShape:n(this.dotShape),dotSize:n(this.dotSize),dotValue:n(this.dotValue),legendOptions:n(this.legendOptions),outline:n(this.outline),referenceScale:n(this.referenceScale),visualVariables:n(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}getControllerHash(){return`${this.attributes?.map(s=>s.field||s.valueExpression||"")}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(e,s){await this.collectVVRequiredFields(e,s);for(const r of this.attributes??[])r.valueExpression&&await j(e,s,r.valueExpression),r.field&&e.add(r.field)}};t([i({type:[B],json:{write:!0}})],l.prototype,"attributes",void 0),t([i({type:y,json:{write:!0}})],l.prototype,"backgroundColor",void 0),t([i({type:Boolean,json:{write:!0}})],l.prototype,"dotBlendingEnabled",void 0),t([i({type:String,json:{write:!1}})],l.prototype,"dotShape",void 0),t([i({type:Number,json:{write:!0}})],l.prototype,"dotSize",void 0),t([i({type:ye,json:{write:!0}})],l.prototype,"legendOptions",void 0),t([i({type:T,json:{default:null,write:!0}})],l.prototype,"outline",void 0),t([i({type:Number,json:{write:!0}})],l.prototype,"dotValue",void 0),t([i({type:Number,json:{write:!0}})],l.prototype,"referenceScale",void 0),t([i({type:Number,json:{write:!0}})],l.prototype,"seed",void 0),t([$({dotDensity:"dot-density"})],l.prototype,"type",void 0),l=O=t([d("esri.renderers.DotDensityRenderer")],l);const de=l;let m=class extends E(w){constructor(){super(...arguments),this.minLabel=null,this.maxLabel=null,this.title=null}};t([i({type:String,json:{write:!0}})],m.prototype,"minLabel",void 0),t([i({type:String,json:{write:!0}})],m.prototype,"maxLabel",void 0),t([i({type:String,json:{write:!0}})],m.prototype,"title",void 0),m=t([d("esri.renderers.support.HeatmapLegendOptions")],m);var N;const J="esri.renderers.HeatmapRenderer",he=H.getLogger(J);function F(e){if(e!=null){const{maxDensity:s,minDensity:r,radius:u}=e;if(s!=null||r!=null||u!=null){const{blurRadius:we,maxPixelIntensity:ve,minPixelIntensity:fe,...X}=e;return X}}return e}let o=N=class extends g{constructor(e){super(e),this.authoringInfo=null,this.colorStops=[new f({ratio:0,color:new y("rgba(255, 140, 0, 0)")}),new f({ratio:.75,color:new y("rgba(255, 140, 0, 1)")}),new f({ratio:.9,color:new y("rgba(255, 0,   0, 1)")})],this.field=null,this.fieldOffset=0,this.legendOptions=null,this.maxDensity=.04,this.minDensity=0,this.radius=18,this.referenceScale=0,this.type="heatmap",this.valueExpression=null,this.valueExpressionTitle=null,this._warnedProps={blurRadius:!1,maxPixelIntensity:!1,minPixelIntensity:!1}}normalizeCtorArgs(e){return F(e)}get blurRadius(){return le(this.radius)}set blurRadius(e){const s=this.maxPixelIntensity,r=this.minPixelIntensity;this._set("radius",ae(e)),this._warnAboutDeprecatedGaussianBlurProp("blurRadius","radius"),this._set("maxDensity",s*this._pixelIntensityToDensity),this._set("minDensity",r*this._pixelIntensityToDensity)}get maxPixelIntensity(){return this.maxDensity/this._pixelIntensityToDensity}set maxPixelIntensity(e){this._set("maxDensity",e*this._pixelIntensityToDensity),this._warnAboutDeprecatedGaussianBlurProp("maxPixelIntensity","maxDensity")}get minPixelIntensity(){return this.minDensity/this._pixelIntensityToDensity}set minPixelIntensity(e){this._set("minDensity",e*this._pixelIntensityToDensity),this._warnAboutDeprecatedGaussianBlurProp("minPixelIntensity","minDensity")}get _pixelIntensityToDensity(){return 24/(ue**2*this.blurRadius**4)}_warnAboutDeprecatedGaussianBlurProp(e,s){this._warnedProps[e]||W(this).getDefaultOrigin()==="user"&&(this._warnedProps[e]=!0,Y(()=>{te(he,e,{replacement:`${String(s)} (suggested value: ${this._get(s)})`,version:"4.24"})}))}read(e,s){e=F(e),super.read(e,s)}getSymbol(){return new C}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}async collectRequiredFields(e,s){const r=this.field,u=this.valueExpression;r&&typeof r=="string"&&await ee(e,s,r),u&&typeof u=="string"&&await j(e,s,u)}getAttributeHash(){return null}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new N({authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),colorStops:n(this.colorStops),field:this.field,legendOptions:n(this.legendOptions),maxDensity:this.maxDensity,minDensity:this.minDensity,radius:this.radius,referenceScale:this.referenceScale,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};t([i({type:oe,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],o.prototype,"authoringInfo",void 0),t([i({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],o.prototype,"blurRadius",null),t([i({type:[f],json:{write:!0}})],o.prototype,"colorStops",void 0),t([i({type:String,json:{write:!0}})],o.prototype,"field",void 0),t([i({type:Number,json:{write:{overridePolicy:(e,s,r)=>({enabled:r==null})},origins:{"web-scene":{write:!1}}}})],o.prototype,"fieldOffset",void 0),t([i({type:m,json:{write:!0}})],o.prototype,"legendOptions",void 0),t([i({type:Number,json:{write:!0}})],o.prototype,"maxDensity",void 0),t([i({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],o.prototype,"maxPixelIntensity",null),t([i({type:Number,json:{write:!0}})],o.prototype,"minDensity",void 0),t([i({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],o.prototype,"minPixelIntensity",null),t([i({type:Number,cast:M,json:{write:!0}})],o.prototype,"radius",void 0),t([i({type:Number,range:{min:0},json:{default:0,write:!0}})],o.prototype,"referenceScale",void 0),t([$({heatmap:"heatmap"})],o.prototype,"type",void 0),t([i({type:String,json:{write:!0,origins:{"web-document":{write:!1},"portal-item":{write:!1}}}})],o.prototype,"valueExpression",void 0),t([i({type:String})],o.prototype,"valueExpressionTitle",void 0),t([i({readOnly:!0})],o.prototype,"_pixelIntensityToDensity",null),o=N=t([d(J)],o);const G=o;let b=class extends E(w){constructor(){super(...arguments),this.color=new y([0,0,0,0]),this.label=null,this.threshold=0}};t([i({type:y,json:{write:!0}})],b.prototype,"color",void 0),t([i({type:String,json:{write:!0}})],b.prototype,"label",void 0),t([i({type:Number,range:{min:0,max:1},json:{write:!0}})],b.prototype,"threshold",void 0),b=t([d("esri.renderers.support.OthersCategory")],b);let S=class extends E(w){constructor(){super(...arguments),this.title=null}};t([i({type:String,json:{write:!0}})],S.prototype,"title",void 0),S=t([d("esri.renderers.support.PieChartLegendOptions")],S);let a=class extends D(E(g)){constructor(e){super(e),this.attributes=null,this.backgroundFillSymbol=null,this.defaultColor=new y([0,0,0,0]),this.defaultLabel=null,this.holePercentage=0,this.othersCategory=new b,this.legendOptions=null,this.outline=null,this.size=12,this.type="pie-chart"}getSymbol(){return new C({size:this.size?this.size/2+(this.outline?.width||0):0})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol(),this.backgroundFillSymbol].filter(ie)}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((e,s)=>e+s.getAttributeHash(),"")}getMeshHash(){return this.getSymbols().reduce((e,s)=>e+JSON.stringify(s),"")}async collectRequiredFields(e,s){await this.collectVVRequiredFields(e,s);for(const r of this.attributes)r.valueExpression&&await j(e,s,r.valueExpression),r.field&&e.add(r.field)}};t([i({type:[B],json:{write:!0}})],a.prototype,"attributes",void 0),t([i({type:q,json:{default:null,write:!0}})],a.prototype,"backgroundFillSymbol",void 0),t([i({type:y,json:{write:!0}})],a.prototype,"defaultColor",void 0),t([i({type:String,json:{write:!0}})],a.prototype,"defaultLabel",void 0),t([i({type:Number,range:{min:0,max:1},json:{write:!0}})],a.prototype,"holePercentage",void 0),t([i({type:b,json:{write:!0}})],a.prototype,"othersCategory",void 0),t([i({type:S,json:{write:!0}})],a.prototype,"legendOptions",void 0),t([i({type:T,json:{default:null,write:!0}})],a.prototype,"outline",void 0),t([i({type:Number,cast:M,json:{write:!0}})],a.prototype,"size",void 0),t([$({pieChart:"pie-chart"})],a.prototype,"type",void 0),a=t([d("esri.renderers.PieChartRenderer")],a);const ce=a;var _;let c=_=class extends D(g){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.type="simple"}async collectRequiredFields(e,s){await Promise.all([this.collectSymbolFields(e,s),this.collectVVRequiredFields(e,s)])}async collectSymbolFields(e,s){await Promise.all(this.getSymbols().map(r=>r.collectRequiredFields(e,s)))}getSymbol(e,s){return this.symbol}async getSymbolAsync(e,s){return this.symbol}getSymbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((e,s)=>e+s.getAttributeHash(),"")}getMeshHash(){return this.getSymbols().reduce((e,s)=>e+JSON.stringify(s),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new _({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:n(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}};t([i({type:String,json:{write:!0}})],c.prototype,"description",void 0),t([i({type:String,json:{write:!0}})],c.prototype,"label",void 0),t([i(ne)],c.prototype,"symbol",void 0),t([$({simple:"simple"})],c.prototype,"type",void 0),c=_=t([d("esri.renderers.SimpleRenderer")],c);const U=c,be={key:"type",base:g,typeMap:{heatmap:G,simple:U,"unique-value":L,"class-breaks":k,"dot-density":de,dictionary:pe,"pie-chart":ce},errorContext:"renderer"},Ee={key:"type",base:g,typeMap:{simple:U,"unique-value":L,"class-breaks":k,heatmap:G},errorContext:"renderer"};function De(e,s){return me(e,null,s)}const ge=se({types:be});function me(e,s,r){return e?e&&(e.styleName||e.styleUrl)&&e.type!=="uniqueValue"?(r&&r.messages&&r.messages.push(new re("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+e.type+"'",{definition:e,context:r})),null):ge(e,s,r):null}export{f as a,U as b,Ee as n,me as o,be as p,De as t};
